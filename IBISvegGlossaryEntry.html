<! DOCTYPE html>
<html lang="EN" dir="ltr" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/xml; charset=utf-8" />
<title>
  Enter Vegetable LookUp Terms
</title>
<script type="text/javascript" src="jquery-1.11.3.js"> </script>
<script type="text/javascript" src="Gmain.js"> </script>
<script type="text/javascript" src="dateshorts.js"> </script>

<script type="text/javascript">
	
	$(document).ready(function(){
	
          $('.clickme').change(handleFileSelect);
          
	  if (sessionStorage.userRef){
             sessVar = sessionStorage.userRef;
	     sesA = sessVar.split(":");
	      conID = sesA[1];
	      $('#contrib_ID').val(conID);
	      $('#ICval').val(0);	
	  }else {
	    alert("You should really not be on this page!")
	    document.location = "IBISmain.html";
	  }
        }) 
	 
       </script>
<link rel="stylesheet"
  type="text/css"
  href="IBIS_maincss.css"
/>
<link rel="stylesheet"
  type="text/css"
  href="vegGloss.css "
/>
</head>
<body id="TheBody" onload="initForm()">
  <div id="dateTime">
  <div id="dateBlock">The Date</div>
  <div id="timeBlock">The Time</div>       
  </div>
  <div id="logo_image_holder">
    <img id="logo_image" src="./images/Logo1_fullsizetransp.png"/>
  </div>
  <input type="button" class="buttClass" value="Send Entry To IBIS" onclick="submitForm()"/>
  <input type="text" id="ICval" name="ICVal" value="" />
  <div id=allContainer class="ac">
    <input type="button" class="buttClass" value="Add another Item" onclick="addAnotherItem()"/>
    <div id="glossEntry"></div>
    
   <div id=mesText> </div>
  </div>
 </body>
  <script type="text/javascript">
 
  function showImage(that){
    var imgdiv = that.nextSibling.src;
   // alert(imgdiv);
  //	imgdiv.innerHTML = '<img src="" alt="this is where the image will go" />';
    if (that.files && that.files[0]){
      var reader = new FileReader();
      reader.onload = function (e) {
      that.nextSibling.nextSibling.src = e.target.result;
    }
    reader.readAsDataURL(that.files[0]);
  }
  $(that)
  /*	that.nextSibling.style.display = "none";
  that.nextSibling.style.display = "block";	*/// I wanted to do something here..but i guess i need some sleep	
  }

  function addAnotherItem(){
    IC = $('#ICval').val() ;
    IC++;
    $('#ICval').val(IC);
  alert("at least its running the functionand IC is " + IC);
    var addItem ='\
    <form name="glossentry'+ IC +'" id="glossEntry" method="POST" enctype="multipart/form-data" action="../cgi-bin/vegGlEntry.php3"> \
    	<div id="vegGlosItem'+ IC +'" class="itemC">\
      	<label class="labelText">Term</label>\
      	<input type="text" name="item'+ IC +'" class="inputText shortText" />\
      	<label class="labelText">Definition</label>\
      	<textarea name="definition'+ IC +'" class="inputText longText"></textarea>\
      	<div id="imageDiv'+ IC +'">\
					<label class="labelC">Add a Diagram</label>\
					</br>\
					<input id="pictures'+ IC +'" type ="file" name="pictures'+ IC +'" class="clickme" onchange="handleFileSelect()" /></br>\
        	<div id="diagram0" class="hidden"> \
        	<div id="glosspic'+ IC +'" class="glossP"></div>\
	  				<label class="labelText" onclick="addCaption(this)">Caption</label></br>\
	  				<input type="text" name="diagramCap0"  />\
					</div>\
					<div id="newtagslist'+ IC +'" class="nothiddentext"></div>\
      </div>\
    </div></form>';
    $('#glossEntry').append(addItem);
    //	alert("and it finishes the function");
  }
  
  function handleFileSelect(evt) {
  	 IC  = $('#ICval').val();
  	alert(IC);
		var files = evt.target.files; 
		for (var i = 0, f; f = files[i]; i++) {
	  	if (!f.type.match('image.*')) {
	 	 	continue;
	 	}
	 	var reader = new FileReader();
		reader.onload = (function(theFile) {
	  return function(e) {
		document.getElementByID("glosspic" + IC).HTML('<img class="thumbpic" src="'+ e.target.result + '" title="'+ escape(theFile.name)+ '" onclick="showOps(this)" /\>');	
	  };
	})(f);
	reader.readAsDataURL(f);
  }
}

  function submitForm(){
    document.glossentry.submit();
  }
 </script> 
</html>
